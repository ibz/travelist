{% extends "content.html" %}

{% block htmlhead %}
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key={{ settings.GOOGLE_MAPS_API_KEY }}" type="text/javascript"></script>
<script src="{{ MEDIA_URL }}javascript/lib/markermanager.js" type="text/javascript"></script>

<script src="{{ MEDIA_URL }}javascript/trip.js" type="text/javascript"></script>
{% endblock %}

{% block script %}
$(document).ready(function() { init_trip({{ trip.id }}, {% if trip.point_set.count %}true{% else %}false{% endif %}); });
$(document).unload(cleanupMap);
{% endblock %}

{% block summary %}
<div id="trip-info">
  Started on: <span id="start-date"></span><br />
  Ended on: <span id="end-date"></span><br />
  Visibility: <span id="visibility"></span><br />
  Owned by: {% ifequal user.id trip.user_id %}me{% else %}{{ trip.user.username }}{% endifequal %}<br />
</div>
<div id="trip-info-edit" class="edit-box" style="display: none;">
  <form action="/trips/{{ trip.id }}/edit/" method="POST">
  <table width="100%">
    <thead class="edit-box-header"><th>Edit trip</th><td></td></thead>
    {{ trip_edit_form }}
  </table>
  <input type="submit" class="button" value="Save" />
  <input type="button" class="button cancel" value="Cancel" onclick="javascript:edit_trip_cancel();">
  </form>
</div>
{% endblock %}

{% block operations %}
  {% ifequal user.id trip.user_id %}
  <a id="trip-info-edit-link" class="navigation" href="javascript:edit_trip();">edit trip</a><br />
  <a class="navigation" href="/trips/{{ trip.id }}/annotations/">edit annotations</a>
  {% endifequal %}
{% endblock %}

{% block content %}
<table width="1000px">
  <tr>
    <td width="400px" valign="top"><div id="trip-details"></div></td>
    <td valign="top"><div id="map" class="map" style="width: 600px; height: 400px"></div></td>
  </tr>
</table>
{% endblock %}
