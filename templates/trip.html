{% extends "page.html" %}

{% load cachedfile %}

{% block htmlhead %}
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key={{ settings.GOOGLE_MAPS_API_KEY }}" type="text/javascript"></script>
<script src="{{ MEDIA_URL }}{% cachedfile "javascript/c/google-maps-all.js" %}" type="text/javascript"></script>
<script src="{{ MEDIA_URL }}javascript/trip.js" type="text/javascript"></script>
{% endblock %}

{% block script %}
$(document).ready(function() { init_trip({{ trip.id }}, {% if trip.point_set.count %}true{% else %}false{% endif %}, {% ifequal trip.user user %}true{% else %}false{% endifequal %}); });
$(document).unload(cleanupMap);
{% endblock %}

{% block content %}
<div class="column span-10 prepend-top append-bottom">
  <h2>{{ trip.name }}</h2>
</div>
<div id="trip-info" class="column span-7 prepend-top append-bottom">
  Started on: {{ trip.start_date|date }}<br />
  Ended on: {{ trip.end_date|date }}<br />
  Owned by: {% ifequal user.id trip.user_id %}me{% else %}{{ trip.user.username }}{% endifequal %}<br />
</div>
<div class="column span-7 prepend-top append-bottom last right">
  {% ifequal user.id trip.user_id %}
  <a href="/trips/{{ trip.id }}/edit/">edit trip</a><br />
  <a href="javascript:delete_trip({{ trip.id }});">delete trip</a><br />
  {% endifequal %}
</div>
<hr />
<div id="trip-activity" style="display: none;"><img src="{{ MEDIA_URL }}images/ajax.gif" /></div>
<div id="trip-details" class="column span-6 prepend-top"></div>
<div class="column span-18 prepend-top last"><div id="map"></div></div>
{% endblock %}
